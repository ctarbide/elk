. ../../../config/system
. ../../../config/site

if [ _$load_obj = _ld -o _$load_obj = _dl ]; then
    force_load_xm="-u ${syms_begin_with}XmIsMotifWMRunning"
fi

# In HP-UX, the Motif libraries must be linked with xt-motif.o instead
# of placing them into the load-libraries (I don't know why):

if [ _$load_obj = _shl ]; then
    motif_link_libs="$libxmotif"
else
    motif_link_libs=
fi


echo Building Makefile.local...
cat <<EOT >Makefile.local
# This Makefile was produced by running ./build in this directory.

SHELL=/bin/sh

CC= ${cc-cc}
CFLAGS= $cflags $obj_cflags
LINTFLAGS= $lintflags

XTDIR=	../../xt

O=	\$(XTDIR)/accelerator.o\\
	\$(XTDIR)/action.o\\
	\$(XTDIR)/callback.o\\
	\$(XTDIR)/class.o\\
	\$(XTDIR)/classname.o\\
	\$(XTDIR)/context.o\\
	\$(XTDIR)/converter.o\\
	\$(XTDIR)/error.o\\
	\$(XTDIR)/function.o\\
	\$(XTDIR)/identifier.o\\
	\$(XTDIR)/init.o\\
	\$(XTDIR)/objects.o\\
	\$(XTDIR)/popup.o\\
	\$(XTDIR)/resource.o\\
	\$(XTDIR)/translation.o\\
	\$(XTDIR)/widget.o

.c.o:
	@echo ""
	@echo === Must make files in \$(XTDIR) first\! ===
	@echo ""

xt-motif.so: \$(O) ../../xlib/xlib.so
	gcc -shared -o \$@ \$(O) ../../xlib/*.o $force_load_xm $libxmotif -lc

xt-motif.pre: \$(O) ../../xlib/xlib.pre
	../../../scripts/makedl \$@ \$(O) ../../xlib/*.o $motif_link_libs

install: xt-motif.so
	-@if [ ! -d $install_dir/lib ]; then \\
	    echo mkdir $install_dir/lib; \\
	    mkdir $install_dir/lib; \\
	fi
	-@if [ ! -d $install_dir/lib/elk ]; then \\
	    echo mkdir $install_dir/lib/elk; \\
	    mkdir $install_dir/lib/elk; \\
	fi
	cp xt-motif.so $install_dir/lib/elk

lint:

clean:
	rm -f *.so *.o xt-motif.pre core

distclean:
	rm -f *.so *.o xt-motif.pre core Makefile.local
EOT
